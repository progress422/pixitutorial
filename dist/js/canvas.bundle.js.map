{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/canvas.js"],"names":["world","characterBody","cameraPos","player","fixedDeltaTime","graphics","maxSubSteps","p2","World","SCENERY_GROUP","PLAYER_GROUP","characterShape","Box","width","height","collisionGroup","Body","mass","position","fixedRotation","damping","type","KINEMATIC","addShape","addBody","KinematicCharacterController","body","collisionMask","velocityXSmoothing","timeToJumpApex","skinWidth","on","update","lastTimeStep","vec2","lerp","interpolatedPosition","Application","PIXI","loader","resources","Sprite","TextureCache","utils","Rectangle","app","resolution","add","tilemap","playerView","parseTileMap","document","appendChild","view","setup","setBackground","draw","setPlayer","ticker","delta","console","log","bodies","renderer","render","step","x","y","i","length","drawBody","boxShape","shapes","Graphics","beginFill","drawRect","stage","addChild","texture","set","vx","vy","bg","tilemapSource","fetch","then","res","json","data","rows","cols","tileWidth","tilewidth","tileHeight","tileheight","tilemapPrefix","layers","map","layer","tilesets","tileset","firstgid","tiles","loadTiles","tileImagesArr","pathToImages","tileStartId","tile","id","image","img","alias","src","load","rowNumber","index","tileX","tileY","setTileOnMap","left","right","window","addEventListener","evt","keyCode","setJumpKeyState","input","addStaticCircle","angle","radius","shape","Circle","addStaticBox"],"mappings":"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","file":"./js/canvas.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/canvas.js\");\n","// import utils from './utils'\n// import { log } from 'util';\nlet world,\n    characterBody,\n    cameraPos = [0, 0],\n    player,\n    fixedDeltaTime = 1 / 60,\n    graphics,\n    maxSubSteps = 10;\n// Init world\nworld = new p2.World();\n\n// Collision groups\nconst SCENERY_GROUP = 0x01;\nconst PLAYER_GROUP = 0x02;\n\n// Add a character body\nlet characterShape = new p2.Box({\n    width: 1,\n    height: 1.5,\n    collisionGroup: PLAYER_GROUP\n});\ncharacterBody = new p2.Body({\n    mass: 0,\n    position:[800,800],\n    fixedRotation: true,\n    damping: 0,\n    type: p2.Body.KINEMATIC\n});\ncharacterBody.addShape(characterShape);\nworld.addBody(characterBody);\n\n// Create the character controller\nplayer = new p2.KinematicCharacterController({\n    world: world,\n    body: characterBody,\n    collisionMask: SCENERY_GROUP,\n    velocityXSmoothing: 0.0001,\n    timeToJumpApex: 0.4,\n    skinWidth: 0.1\n});\n\n// Update the character controller after each physics tick.\nworld.on('postStep', function(){\n    player.update(world.lastTimeStep);\n});\n\np2.vec2.lerp(\n    cameraPos,\n    cameraPos,\n    [-characterBody.interpolatedPosition[0], -characterBody.interpolatedPosition[1]],\n    0.05\n);\n\n// -----------------------------------------------------------\n// -----------------------------------------------------------\n// -----------------------------------------------------------\n// -----------------------------------------------------------\n\n//Aliases\nconst Application = PIXI.Application,\n    loader = PIXI.loader,\n    resources = PIXI.loader.resources,\n    Sprite = PIXI.Sprite,\n    TextureCache = PIXI.utils.TextureCache,\n    Rectangle = PIXI.Rectangle;\n\nconst app = new Application({\n    width: 1920,\n    height: 1024,\n    resolution: 1\n});\n\n\n// laod background\nloader.add('background', '/img/teamfun/Background2.png')\n.add('player', '/img/teamfun/player.png');\n\nconst tilemap = {};\nlet playerView;\n\nparseTileMap('/img/teamfun/tilemapjsontestcsv.json');\n\n\n \ndocument.body.appendChild(app.view);\n\nfunction setup() {\n    setBackground();\n    tilemap.draw();\n    setPlayer();\n    app.ticker.add(delta => update(delta));\n    console.log(world.bodies);\n    \n}\nconsole.log('height----------',app.renderer.height);\nrender();\nfunction update(delta) {\n    world.step(1/60);\n    // console.log(player.input[0]);\n    // Transfer positions of the physics objects to Pixi.js\n    graphics.position.x = characterBody.position[0];\n    graphics.position.y = characterBody.position[1];\n    console.log(graphics.position);\n    \n}\n\nfunction render() {\n    for(var i=0; i<world.bodies.length; i++){\n        var body = world.bodies[i];\n        drawBody(body);\n    }\n}\n\nfunction drawBody(body){\n    let x = body.interpolatedPosition[0],\n        y = body.interpolatedPosition[1],\n        boxShape = body.shapes[0];\n\n    graphics = new PIXI.Graphics();\n\n    if(boxShape instanceof p2.Box){\n      graphics.beginFill(0xff0000);\n      graphics.drawRect(-boxShape.width/2, -boxShape.height/2, boxShape.width, boxShape.height);\n    }\n    \n    console.log(graphics);\n    \n    // Add the box to our container\n    app.stage.addChild(graphics);\n}\n\nfunction setPlayer() {\n    playerView = new PIXI.Sprite(\n        PIXI.loader.resources['player'].texture\n    );\n    playerView.position.set(350,500);\n    playerView.vx = 0;\n    playerView.vy = 5;\n\n    app.stage.addChild(playerView);\n}\n\nfunction setBackground() {\n    let bg = new PIXI.Sprite(\n        PIXI.loader.resources['background'].texture\n    );\n    app.stage.addChild(bg);\n}\n\nfunction parseTileMap(tilemapSource){\n    fetch(tilemapSource)\n    .then(res => res.json())\n    .then(data => {\n        console.log('all json data',data);\n        console.log('------------------------------------');\n        \n        tilemap.rows = data.height;\n        tilemap.cols = data.width;\n        tilemap.tileWidth = data.tilewidth;\n        tilemap.tileHeight = data.tileheight;\n        tilemap.tilemapPrefix = 'tileimg';\n        tilemap.layers = data.layers.map((layer) => {\n            return {\n                data: layer.data\n            }\n        });\n        tilemap.tilesets = data.tilesets.map((tileset) => {\n            return {\n                firstgid: tileset.firstgid,\n                tiles: tileset.tiles\n            }\n        });\n        console.log('Tilemap',tilemap);\n        console.log('------------------------------------');\n        tilemap.loadTiles();\n    });\n    tilemap.loadTiles = function() {\n        let tileImagesArr = [];\n        let tilemapPrefix = tilemap.tilemapPrefix;\n        const pathToImages = '/img/teamfun/';\n        this.tilesets.map((tileset) => {\n            let tileStartId = tileset.firstgid;\n            tileImagesArr = [...tileImagesArr, ...tileset.tiles.map((tile) => {\n                return {\n                    'alias': tilemapPrefix + (tile.id + tileStartId),\n                    'src': tile.image\n                }\n            })]\n        });\n        // load images to pixi\n        tileImagesArr.map((img) => loader.add(img.alias, pathToImages + img.src));\n        loader.load(setup);\n    }\n    tilemap.draw = function() {\n        let tileWidth = tilemap.tileWidth;\n        let tileHeight = tilemap.tileHeight;\n        let cols = tilemap.cols;\n        tilemap.layers.map((layer) => {\n            let rowNumber = 1;\n            layer.data.map((tile, index) => {\n                if (tile != 0) {\n                    let tileX = (index - cols*(rowNumber-1)) * tileWidth;\n                    let tileY = rowNumber * tileHeight;\n                    \n                    tilemap.setTileOnMap(tileX,tileY,`${tilemap.tilemapPrefix}${tile}`);\n                }\n                if ((index + 1)%cols == 0)\n                    rowNumber += 1;\n            });\n        });\n    }\n    tilemap.setTileOnMap = function(x,y,alias) {\n        let tile = new PIXI.Sprite(\n            PIXI.loader.resources[alias].texture\n        );\n        tile.position.set(x,y-tile.height);\n        app.stage.addChild(tile);\n    }\n}\n\n// Keyboard -------------------------------------------------\n\n// Set up key listeners\nlet left = 0, right = 0;\nwindow.addEventListener('keydown', function(evt){\n  switch(evt.keyCode){\n    case 38: // up key\n    case 32: player.setJumpKeyState(true); break; // space key\n    case 39: right = 1; break; // right key\n    case 37: left = 1; break; // left key\n  }\n  player.input[0] = right - left;\n  console.log(evt.keyCode);\n  \n});\nwindow.addEventListener('keyup', function(evt){\n  switch(evt.keyCode){\n    case 38: // up\n    case 32: player.setJumpKeyState(false); break;\n    case 39: right = 0; break;\n    case 37: left = 0; break;\n  }\n  player.input[0] = right - left;\n});\n\n// Keyboard END -------------------------------------------------\n\n\n\nfunction addStaticCircle(x, y, angle, radius){\n    var shape = new p2.Circle({\n      collisionGroup: SCENERY_GROUP,\n      radius: radius\n    });\n    var body = new p2.Body({\n      position: [x, y],\n      angle: angle\n    });\n    body.addShape(shape);\n    world.addBody(body);\n}\n\nfunction addStaticBox(x, y, angle, width, height){\n    var shape = new p2.Box({\n      collisionGroup: SCENERY_GROUP,\n      width: width,\n      height: height\n    });\n    var body = new p2.Body({\n      position: [x, y],\n      angle: angle\n    });\n    body.addShape(shape);\n    world.addBody(body);\n}"],"sourceRoot":""}